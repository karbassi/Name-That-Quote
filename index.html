<!DOCTYPE html>
<html>
    <head>
        <title>Name that quote</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
        <script type="text/javascript">
        var db = [
            {
                start: "Mon Jan 04 17:31:03 +0000 2010",
                quote: { id: "7373225361", text: "I wanted to be with you alone and talk about the weather." },
                winner: { id: "7373291711", name: "jodiwilldare" },
                end: "Mon Jan 04 17:33:30 +0000 2010"
            },
            {
                start: "Mon Jan 04 20:43:37 +0000 2010",
                quote: { id: "7378324868", text: "Some of them want to use you.<br>Some of them want to get used by you" },
                winner: { id: "7378393919", name: "swirlee" },
                end: "Mon Jan 04 20:46:11 +0000 2010"
            },
            {
                start: "Mon Jan 04 21:28:18 +0000 2010",
                quote: { id: "7379546653", text: "I stand here naked as the day I was born<br>Face to the dawn and my faith in the" },
                winner: { id: "7379699388", name: "migganimon" },
                end: "Mon Jan 04 21:33:44 +0000 2010"
            },
            {
                start: "Tue Jan 05 16:30:14 +0000 2010",
                quote: { id: "7407825156", text: "Girl I want to make you sweat<br>Sweat till you can't sweat no more" },
                winner: { id: "7408034982", name: "swirlee" },
                end: "Tue Jan 05 16:37:51 +0000 2010"
            }
        ];

        jQuery(document).ready(function($) {
            var str = [],
                winners = {};
            $.each(db, function(i, o) {
                var s = new Date(o.start),
                    e = new Date(o.end),
                    diff = (e.getTime() - s.getTime()) / 1000
                ;
                str.push(
                    '<tr scope="row">',
                    '   <td headers="s" class="center">', s.toLocaleDateString(), ' ', s.toLocaleTimeString(), '</td>',
                    '   <td headers="q"><a href="http://twitter.com/karbassi/status/', o.quote.id, '">', o.quote.text, '</a></td>',
                    '   <td headers="w"><a href="http://twitter.com/', o.winner.name, '/status/', o.winner.id, '">@', o.winner.name, '</a></td>',
                    '   <td headers="e" class="center">', e.toLocaleDateString(), ' ', e.toLocaleTimeString(), '</td>',
                    '   <td headers="d" class="right">', diff, 's</td>',
                    '</tr>'
                );
                winners[o.winner.name] = winners[o.winner.name] + 1 || 1;
            });

            $('#list > tbody').append(str.join(''));

            console.dir(winners);

            str = [];

            $.each(winners, function(i, o){
                console.debug(i, o);
                str.push(
                    '<tr scope="row">',
                    '   <td><a href="http://twitter.com/', i, '/">', i, '</a></td>',
                    '   <td>', o, '</td>',
                    '</tr>'
                );
            });

            $('#points > tbody').append(str.join(''));


        });
        </script>
        <style type="text/css" media="screen">
            body {width:960px;margin: 3em auto;font: 1em/1.3em Helvetica, sans-serif;background-color: #F9FCFF;}
            tr, th, td {padding: 10px;}
            a {text-decoration: none;color: #000;}
            a:hover {color: #FFAC00;}
            .center {text-align: center;}
            .right {text-align: right;}
            table th { color: #000; background-color: #FFDDBC; }

            #s, #e, #d {width:90px;}

        </style>
    </head>
    <body>
        <h1>Name That Quote</h1>
        <table id="list">
            <thead>
                <tr>
                    <th id="s" scope="col">Date-Time</th>
                    <th id="q" scope="col">Quote</th>
                    <th id="w" scope="col">Winner</th>
                    <th id="e" scope="col">First</th>
                    <th id="d" scope="col">Speed</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

        <table id="points">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Points</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

    </body>
</html>
